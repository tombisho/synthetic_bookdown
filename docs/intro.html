<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction | dsSynthetic: A DataSHIELD package to generate synthetic data</title>
  <meta name="description" content="The purpose of this book is to help the reader use dsSynthetic to help with data harmonisation and analysis when working on federated data sets with DataSHIELD" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction | dsSynthetic: A DataSHIELD package to generate synthetic data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The purpose of this book is to help the reader use dsSynthetic to help with data harmonisation and analysis when working on federated data sets with DataSHIELD" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction | dsSynthetic: A DataSHIELD package to generate synthetic data" />
  
  <meta name="twitter:description" content="The purpose of this book is to help the reader use dsSynthetic to help with data harmonisation and analysis when working on federated data sets with DataSHIELD" />
  

<meta name="author" content="Tom Bishop, Soumya Banerjee" />


<meta name="date" content="2021-12-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="synthpop.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">dsSynthetic: Synthetic data generation with DataSHIELD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#synopsis"><i class="fa fa-check"></i><b>1.1</b> Synopsis</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.2</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#assumptions"><i class="fa fa-check"></i><b>2.1</b> Assumptions</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>2.2</b> Motivation</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#hypothesis-for-using-synthetic-data"><i class="fa fa-check"></i><b>2.3</b> Hypothesis for using synthetic data</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#overview-of-steps"><i class="fa fa-check"></i><b>2.4</b> Overview of steps</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#working-with-single-studies"><i class="fa fa-check"></i><b>2.5</b> Working with single studies</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#prerequisites"><i class="fa fa-check"></i><b>2.6</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="synthpop.html"><a href="synthpop.html"><i class="fa fa-check"></i><b>3</b> Generating data using synthpop methods</a><ul>
<li class="chapter" data-level="3.1" data-path="synthpop.html"><a href="synthpop.html#details"><i class="fa fa-check"></i><b>3.1</b> Details</a></li>
<li class="chapter" data-level="3.2" data-path="synthpop.html"><a href="synthpop.html#brief-comments-on-the-validity-of-the-data"><i class="fa fa-check"></i><b>3.2</b> Brief comments on the validity of the data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis with synthetic data</a><ul>
<li class="chapter" data-level="4.1" data-path="analysis.html"><a href="analysis.html#getting-set-up"><i class="fa fa-check"></i><b>4.1</b> Getting set up</a></li>
<li class="chapter" data-level="4.2" data-path="analysis.html"><a href="analysis.html#create-synthetic-dataset"><i class="fa fa-check"></i><b>4.2</b> Create synthetic dataset</a></li>
<li class="chapter" data-level="4.3" data-path="analysis.html"><a href="analysis.html#start-dslite-local-instance"><i class="fa fa-check"></i><b>4.3</b> Start DSLite local instance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="harmonisation.html"><a href="harmonisation.html"><i class="fa fa-check"></i><b>5</b> Harmonisation with synthetic data</a><ul>
<li class="chapter" data-level="5.1" data-path="harmonisation.html"><a href="harmonisation.html#getting-set-up-1"><i class="fa fa-check"></i><b>5.1</b> Getting set up</a></li>
<li class="chapter" data-level="5.2" data-path="harmonisation.html"><a href="harmonisation.html#do-the-work"><i class="fa fa-check"></i><b>5.2</b> Do the work</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simstudy.html"><a href="simstudy.html"><i class="fa fa-check"></i><b>6</b> Generating data using simstudy methods</a><ul>
<li class="chapter" data-level="6.1" data-path="simstudy.html"><a href="simstudy.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="simstudy.html"><a href="simstudy.html#details-1"><i class="fa fa-check"></i><b>6.2</b> Details</a></li>
<li class="chapter" data-level="6.3" data-path="simstudy.html"><a href="simstudy.html#brief-comments-on-the-validity-of-the-data-1"><i class="fa fa-check"></i><b>6.3</b> Brief comments on the validity of the data</a></li>
<li class="chapter" data-level="6.4" data-path="simstudy.html"><a href="simstudy.html#comparing-synthpop-and-simstudy-approaches"><i class="fa fa-check"></i><b>6.4</b> Comparing <strong>synthpop</strong> and <strong>simstudy</strong> approaches</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">dsSynthetic: A DataSHIELD package to generate synthetic data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction</h1>
<div id="assumptions" class="section level2">
<h2><span class="header-section-number">2.1</span> Assumptions</h2>
<p>It is assumed that the reader is familiar with the basic concepts and motivations around using DataSHIELD for federated analysis. More information about this can be found <a href="https://isglobal-brge.github.io/resource_bookdown/datashield.html">here</a>.</p>
<p>An understanding of <a href="https://isglobal-brge.github.io/resource_bookdown/dslite-datashield-implementation-on-local-datasets.html">DSLite</a> will be useful in the sections that describe the use of synthetic data for developing analysis code.</p>
<p>Likewise, some knowledge of <a href="https://opaldoc.obiba.org/en/latest/magma-user-guide/index.html">MagmaScript</a> (which is basically JavaScript) would be helpful for the parts on harmonisation.</p>
</div>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">2.2</span> Motivation</h2>
<p>The benefits of a non-disclosive federated approach are that data can be harmonised and analysed without giving complete access to the data or transferring the data to another location. The avoidance of data transfer agreements is realised in DataSHIELD by only allowing analysts to execute commands that return non-disclosive summary statistics. A less desirable consequence of this approach is that it is more challenging for analysts to write, test and debug their scripts, and for data experts to harmonise data to common standards, when the data are not tangibly in front of them. One could say that it is like trying to build a Lego model while wearing a blindfold.</p>
<p>Writing, testing and debugging analysis pipelines in DataSHIELD can be challenging because the analyst cannot easily see what is happening to the data they are manipulating. DataSHIELD relies on them only having summary access to the data. It is therefore possible for analysts to make checks to validate that their analysis is progressing as planned. This has to be done via non-disclosive information about the data that the analysis has generated. For example, to confirm that a subset into male and female groups has been successful, the analyst could ask for a summary of the original gender column and check the counts of male and female participants match the length of the subset dataframes. However, this process can be clumsy, especially for more complex functions such as <code>ds.lexis</code> and <code>ds.reshape</code>. More challenging can be when a command returns an error message - without seeing the data it can be hard to work out why things are not working.</p>
<p>With harmonisation, one option is to transfer and centralise the data, but this negates one of the benefits of the federated approach. While it is only necessary for the harmonisation team to receive the data, a lot of bureaucracy is required because a full data transfer is still needed. Another approach is to have each group harmonise their own data. The challenge with this approach is that there can be inconsistencies in the approach of different teams, and each team needs training and expertise in the harmonisation process. The approach that avoids this is for one expert group to perform the harmonisation for each dataset while it remains on its hostâ€™s server, and only allowing access to data summaries. The challenge again is that not being able to see the complete dataset makes it harder to write the harmonisation code.</p>
</div>
<div id="hypothesis-for-using-synthetic-data" class="section level2">
<h2><span class="header-section-number">2.3</span> Hypothesis for using synthetic data</h2>
<p>R packages like <strong>synthpop</strong> <span class="citation">(Nowok, Raab, and Dibben <a href="#ref-synthpop" role="doc-biblioref">2016</a>)</span> have been developed to generate realistic synthetic data that is not disclosive from an original, sensitive dataset. A DataSHIELD package built on <strong>synthpop</strong> functionality could be used to generate a synthetic data set on the server side which is then transfered to the client side. Users can then develop code on the client side while working with full access to synthetic data to confirm that it is working as expected. When the user is happy that the code is working correctly, it can then be applied to the real data on the server side. The user therefore has the benefit of being able to see the data they are working with, but without the need to go through labourious data transfer processes.</p>
<p>Other packages that provide synthetic data generation are <strong>simstudy</strong> <span class="citation">(Goldfeld and Wujciak-Jens <a href="#ref-simstudy" role="doc-biblioref">2020</a>)</span> and <strong>gcipdr</strong>. Simstudy requires the user to define the characteristics of variables and their relationships. However, non-disclosive access via DataSHIELD can help provide these summary statistics such as means, variances and correlations. There is also the benefit that the user then has precise control over the nature of the synthetic data generated, and the data custodian knows that only summary statistics have been extracted. Likewise, <strong>gcipdr</strong> makes it easy for users to extract features such as mean, standard deviation and correlations via DataSHIELD, and use these to provide a more automated generation of the synthetic data. In <strong>dsSynthetic</strong> we provide functionality built on <strong>simstudy</strong> as it is more mature, has less complex dependencies and is faster. The compromise is that <strong>gcipdr</strong> should provide more accurate results, as it was designed to provide synthetic data that would allow actual inferences to be drawn as from the real data. However for our purposes we only want synthetic data that is realistic enough to develop analysis code and write harmonisation code: this work is then applied to the real data to get the inferences.</p>
</div>
<div id="overview-of-steps" class="section level2">
<h2><span class="header-section-number">2.4</span> Overview of steps</h2>
<p>The overall process of generating synthetic data for code development can be described by the following steps:</p>
<ol style="list-style-type: decimal">
<li>The data custodian uploads the raw data to the server side and installs the server side package <code>dsSynthetic</code></li>
<li>The user installs the package <code>dsSyntheticClient</code> on the client side</li>
<li>The user calls functions in the <code>dsSyntheticClient</code> package to generate a synthetic but non-disclosive data set which is returned to the client side or is built on the client side.</li>
<li>With the synthetic data on the client side, the user can view the data and develop their code. They will be able to see the how the data changes as the code is run.</li>
<li>When the code is complete, it can be run on the server using the real data.</li>
</ol>
<div class="figure"><span id="fig:unnamed-chunk-1"></span>
<img src="images/dssynthetic_general.png" alt="Generating synthetic data for developing code" width="480" />
<p class="caption">
Figure 2.1: Generating synthetic data for developing code
</p>
</div>
</div>
<div id="working-with-single-studies" class="section level2">
<h2><span class="header-section-number">2.5</span> Working with single studies</h2>
<p>Some functions in the <strong>dsSynthetic</strong> packages are currently written to work with single studies. This means that these functions expect to receive a single connection object only, or they will throw an error. If you wish to use an existing connection object with connections to multiple servers, you can select a single connection like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1"></a>connections[<span class="dv">1</span>]</span>
<span id="cb1-2"><a href="intro.html#cb1-2"></a>connections<span class="op">$</span>server1</span></code></pre></div>
<p>The functions that require single connections are those involved in building the synthetic data on the client side, which can be a computationally intensive exercise. Therefore it is sensible to only do this for one study at a time.
Also, in the case of harmonisation, the variables present will be different in different studies and as such will cause problems for many standard DataSHIELD functions (which typically require the same variables in all studies).</p>
</div>
<div id="prerequisites" class="section level2">
<h2><span class="header-section-number">2.6</span> Prerequisites</h2>
<p>To run the code examples in this book and use <strong>dsSynthetic</strong> in your own work you will need a working version of R with the appropriate DataSHIELD packages installed.</p>
<p>Using DataSHIELD on the client side requires the following R packages to be installed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;DSOpal&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-2"><a href="intro.html#cb2-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;dsBaseClient&quot;</span>, <span class="dt">repos =</span> <span class="kw">c</span>(<span class="st">&quot;https://cloud.r-project.org&quot;</span>, <span class="st">&quot;https://cran.obiba.org&quot;</span>), <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>To use <strong>dsSynthetic</strong> on the client side, the client package needs to be installed:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tombisho/dsSyntheticClient&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="intro.html#cb3-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;simstudy&quot;</span>)</span></code></pre></div>
<p>For chapter <a href="analysis.html#analysis">4</a> we require <code>DSLite</code>, <code>dsBase</code> and <code>dsSynthetic</code> to be installed. This allows us to simulate the server side enviroment on the client side:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;DSLite&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-2"><a href="intro.html#cb4-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;dsBase&quot;</span>, <span class="dt">repos =</span> <span class="kw">c</span>(<span class="st">&quot;https://cloud.r-project.org&quot;</span>, <span class="st">&quot;https://cran.obiba.org&quot;</span>), <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-3"><a href="intro.html#cb4-3"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tombisho/dsSyntheticClient&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>, <span class="dt">ref =</span> <span class="st">&quot;main&quot;</span>)</span></code></pre></div>
<p>For chapter <a href="harmonisation.html#harmonisation">5</a> we need to install the R <code>V8</code> package to simulate JavaScript in R. First some system level packages may need to be installed: On Debian / Ubuntu install either <code>libv8-dev</code> or <code>libnode-dev</code>, on Fedora use <code>v8-devel</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="intro.html#cb5-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;V8&quot;</span>)</span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-simstudy">
<p>Goldfeld, Keith, and Jacob Wujciak-Jens. 2020. <em>Simstudy: Illuminating Research Methods Through Data Generation</em>. <em>Journal of Open Source Software</em>. Vol. 5. 54. The Open Journal. <a href="https://doi.org/10.21105/joss.02763">https://doi.org/10.21105/joss.02763</a>.</p>
</div>
<div id="ref-synthpop">
<p>Nowok, Beata, Gillian M. Raab, and Chris Dibben. 2016. <em>Synthpop: Bespoke Creation of Synthetic Data in R</em>. <em>Journal of Statistical Software</em>. Vol. 74. 11. <a href="https://doi.org/10.18637/jss.v074.i11">https://doi.org/10.18637/jss.v074.i11</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="synthpop.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["synthetic_bookdown.pdf", "synthetic_bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
